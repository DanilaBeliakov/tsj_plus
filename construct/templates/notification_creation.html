{% extends "base_construct.html" %}

{% block content %}
<script>
    document.getElementById("id_date_of_start").addEventListener("change", function() {
        var input = this.value;
        var dateOfEndField = document.getElementById("id_date_of_end");
        var minDateValue = new Date(input);
        var maxDateValue = new Date(input);

        minDateValue.setDate(minDateValue.getDate() + 7);
        maxDateValue.setDate(maxDateValue.getDate() + 60);
      // Format the date value as a string in ISO format (YYYY-MM-DD)
        var minFormattedDate = minDateValue.toISOString().substring(0, 10);
        var maxFormattedDate = maxDateValue.toISOString().substring(0, 10);

        dateOfEndField.min = minFormattedDate;
        dateOfEndField.max = maxFormattedDate;
        dateOfEndField.value = minFormattedDate;
        alert(minFormattedDate);
    });

    function setCountingDate() {
          var dateField = document.getElementById("id_date_of_end");
          var minDateField = document.getElementById("id_date_of_counting");

          // Get the date value from the first input field
          var dateValue = new Date(dateField.value);
          var dateValue1 = new Date(dateField.value);

          // Add 7 days to the date value
          dateValue.setDate(dateValue.getDate() + 10);

          // Format the date value as a string in ISO format (YYYY-MM-DD)
          const formattedDate = dateValue.toISOString().substring(0, 10);
          const formattedDate1 = dateValue1.toISOString().substring(0, 10);

          // Set the formatted date as the min value of the second input field
          minDateField.max = formattedDate;
          minDateField.min = formattedDate1;
    }

</script>

<form method="POST" class="notif">
    {% csrf_token %}
    {{ form.type_of_plans.label }}
    <br>
    {{ form.type_of_plans }}
    <br>
    {{ form.type_of_meeting.label }}
    <br>
    {{ form.type_of_meeting }}
    <br>
    <div id="offline_fields" style="display:none">
        {{ form.date_of_start.label }}
        <br>
        {{ form.date_of_start }}
        <br>
        {{ form.time_of_start.label }}
        <br>
        {{ form.time_of_start }}
        <br>
        {{ form.name_of_place.label }}
        <br>
        {{ form.name_of_place }}
        <br>
    </div>
    <div id="online_fields" style="display:none">
        {{ form.date_of_start.label }}
        <br>
        {{ form.date_of_start }}
        <br>
        {{ form.time_of_start.label }}
        <br>
        {{ form.time_of_start }}
        <br>
        {{ form.date_of_end.label }}
        <br>
        {{ form.date_of_end }}
        <br>
        {{ form.time_of_end.label }}

        <br>
        {{ form.time_of_end }}
        <br>
    </div>
    {{ form.place_of_counting.label }}
    <br>
    {{ form.place_of_counting }}
    <br>
    {{ form.date_of_counting.label }}
    <br>
    {{ form.date_of_counting }}
    <br>
    {{ form.time_of_counting.label }}
    <br>
    {{ form.time_of_counting }}
    <br>
    {{ form.invited_people.label }}
    <br>
    {{ form.invited_people }}
    <br>
    {{ form.type_of_initiator.label }}
    <br>
    {{ form.type_of_initiator }}
    <br>
    <div id="owner_fields" style="display:none"></div>
    <div id="representative_fields" style="display:none">
        {{ form.representative_name.label }}
        <br>
        {{ form.representative_name }}
        <br>
        {{ form.attorney.label }}
        <br>
        {{ form.attorney }}
        <br>
    </div>

    <input type="submit" value="Сохранить уведомление" class="btn5">
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
        $(document).ready(function() {
            $('input[type="radio"]').click(function() {
                if($(this).attr('id') == 'id_type_of_initiator_0') {
                    $('#owner_fields').show();
                    $('#representative_fields').hide();
                } else if($(this).attr('id') == 'id_type_of_initiator_1') {
                    $('#owner_fields').hide();
                    $('#representative_fields').show();
                } else if($(this).attr('id') == 'id_type_of_meeting_0') {
                    $('#online_fields').hide();
                    $('#offline_fields').show();
                } else if($(this).attr('id') == 'id_type_of_meeting_1') {
                    $('#offline_fields').hide();
                    $('#online_fields').show();
                } else if($(this).attr('id') == 'id_type_of_meeting_2') {
                    $('#offline_fields').show();
                    $('#online_fields').show();
                }

            });
        });

</script>

{% endblock %}